(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{"68Um":function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n("lTCR");function i(){var e=function(e,t){t||(t=e.slice(0));return e.raw=t,e}(['\n  query ServiceRequestGet {\n    result: ServiceRequestGet\n      @rest(\n        type: "ServiceRequest"\n        path: "citizen/servicerequests"\n        method: "GET"\n      ) {\n      hasServiceRequests\n\n      serviceRequests @type(name: "test") {\n        PK\n        SK\n        entity\n        service\n        reference\n        status\n        createdBy\n        createdAt\n        modifiedBy\n      }\n    }\n  }\n']);return i=function(){return e},e}var r=n.n(a)()(i())},"7n19":function(e,t,n){"use strict";n.r(t);n("VRzm"),n("Btvt"),n("xfY5");var a=n("o0o1"),i=n.n(a),r=(n("ls82"),n("pIFo"),n("q1tI")),c=n.n(r),o=n("vOnD"),s=n("wd/R"),l=n.n(s),u=n("vqTq"),d=n("Udzp"),p=n("BnTh"),m=n("N9+v"),f=n("YCiF"),v=n("ttZb"),b=n("scg8"),y=n("K/A+"),h=n("kytN"),g=n("Wbzz"),w=n("C2HB"),E=n("lTCR");function S(){var e=function(e,t){t||(t=e.slice(0));return e.raw=t,e}(['\n  query ServiceRequestDraftGet {\n    result: ServiceRequestDraftGet\n      @rest(\n        type: "ServiceRequestDraft"\n        path: "citizen/servicerequestdrafts"\n        method: "GET"\n      ) {\n      hasServiceRequestDraft\n\n      serviceRequestDraft @type(name: "test") {\n        SK\n        service\n        content\n        submitted\n        expires\n        createdAt\n        updatedAt\n        SRReference\n        serviceRequest {\n          hasServiceRequest\n          serviceRequest {\n            PK\n            SK\n            entity\n            service\n            reference\n            subReference\n            status\n            createdBy\n            modifiedBy\n          }\n        }\n      }\n    }\n  }\n']);return S=function(){return e},e}var O=n.n(E)()(S()),q=n("iBx0"),x=n("68Um"),j=n("eJi6"),R=n("asXk"),N=n("q8UK");function D(e,t,n,a,i,r,c){try{var o=e[r](c),s=o.value}catch(l){return void n(l)}o.done?t(s):Promise.resolve(s).then(a,i)}function C(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function c(e){D(r,a,i,c,o,"next",e)}function o(e){D(r,a,i,c,o,"throw",e)}c(void 0)}))}}var k=new(n.n(N).a),A=new R.a,_=o.b.section.withConfig({displayName:"applications__ProfileSection",componentId:"sc-1gugv6n-0"})({}),I=[{link:"/dashboard",text:"My dashboard"},{text:"My applications"}],T=Object(o.b)(g.Link).withConfig({displayName:"applications__ApplicationItemLink",componentId:"sc-1gugv6n-1"})([""," text-decoration:none !important;color:#414141 !important;border-bottom:solid 1px #f5f5f5;display:flex;justify-content:space-between;"],{"--bg-opacity":"1",backgroundColor:"rgba(255, 255, 255, var(--bg-opacity))",padding:"1rem",display:"block",textDecoration:"none"}),K=o.b.span.withConfig({displayName:"applications__StyledSpan",componentId:"sc-1gugv6n-2"})(["color:#005e85;cursor:pointer;text-decoration:underline;",":hover &{text-decoration:none;color:#313131;}"],T),B=Object(o.b)("div").withConfig({displayName:"applications___StyledDiv",componentId:"sc-1gugv6n-3"})({display:"inline-block"}),L=Object(o.b)("span").withConfig({displayName:"applications___StyledSpan",componentId:"sc-1gugv6n-4"})({textDecoration:"none"}),P=function(e){var t=e.application,n=e.isDraft,a=Object(q.a)(t.SK),i=n?"/services/"+t.service.toLowerCase().replace(/ /g,"-")+"?id="+a:"detail/?id="+a;return c.a.createElement(T,{to:i,className:"mq-box-shadow"},c.a.createElement(B,null,c.a.createElement(L,null,t.reference," - ",t.service||"No Name"," -"," ",l()(t.createdAt).format("DD MMMM YYYY")||"")),c.a.createElement(K,{className:"text-md"},n?"Continue application":"View details"))};t.default=function(e){e.testCache;var t=Object(v.c)(p.b,{client:Object(w.a)(),fetchPolicy:"cache-first"}),n=t.loading,a=(t.data,Object(v.c)(O,{client:Object(w.a)(),fetchPolicy:"network-only"})),o=a.loading,s=a.data,l=Object(v.c)(x.a,{client:Object(w.a)(),fetchPolicy:"network-only"}),E=l.loading,S=l.data,R=Object(r.useState)(!1),N=R[0],D=R[1],T=Object(r.useState)([]),K=T[0],B=T[1],L=Object(r.useState)([]),G=L[0],M=L[1],z=Object(r.useState)(Object(f.a)().data),Y=z[0],F=z[1],U=Object(r.useState)(!1),J=U[0],V=U[1],W=Object(r.useState)(!1),X=W[0],H=W[1];Object(r.useEffect)((function(){function e(){return(e=C(i.a.mark((function e(){var t,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.isLoggedIn();case 2:if(t=e.sent,V(t),n=A.isConsentOnly(),H(n),!n){e.next=9;break}return Object(g.navigate)("/consent"),e.abrupt("return",(function(){return k.abort()}));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var Z=function(e){Object(j.a)(e.tokenData)?(F(e),D(h.a.IS_USER_REGISTERED(e))):Object(g.navigate)("/401")};return Object(r.useEffect)((function(){if(!o){var e=s.result.serviceRequestDraft.filter((function(e){return!1===e.submitted}));B(e)}}),[s]),Object(r.useEffect)((function(){if(!E){var e,t,n=null==S||null===(e=S.result)||void 0===e||null===(t=e.serviceRequests)||void 0===t?void 0:t.filter((function(e){return"submitted"===e.status}));M(n)}}),[S]),!X&&Y.authAccount.isAuthenticated&&N?c.a.createElement(u.b,{metaTitle:"Applications",isLoggedIn:J,isConsentOnly:X,onCacheLoaded:Z},c.a.createElement(d.a,{title:"My applications",breadcrumbs:I},c.a.createElement(_,null,n||o||E?c.a.createElement("div",{className:"flex flex-col"},"Please wait while we fetch your applications.",c.a.createElement(m.a,{spinnerType:"spinner--lg"})):c.a.createElement(c.a.Fragment,null,c.a.createElement(y.b,{className:"mq-heading2 mq-heading2--no-top-margin"},"Draft applications"),K&&K.length>0?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"text-md -mt-2 mb-3"},"These are applications you have started, but not yet completed. Click through to continue an application."),K.sort((function(e,t){return Number(new Date(t.createdAt))-Number(new Date(e.createdAt))})).map((function(e){var t=Object(q.a)(e.SK);return c.a.createElement(P,{key:t,isDraft:!0,application:e})}))):c.a.createElement("div",{className:"text-md"},"— No draft applications found"),c.a.createElement(y.b,{className:"mq-heading2"},"Submitted applications"),G&&G.length>0?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"text-md -mt-2 mb-3 text-gray-700"},"These are applications you have already submitted. Click through to view their current status."),G.sort((function(e,t){return Number(new Date(t.createdAt))-Number(new Date(e.createdAt))})).map((function(e){return c.a.createElement(P,{key:e.SK,application:e})}))):c.a.createElement("div",{className:"text-md"},"— No submitted applications found"))))):c.a.createElement(u.b,{metaTitle:"Applications",isLoggedIn:J,isConsentOnly:X,onCacheLoaded:Z},c.a.createElement(b.StyledWrapper,null,c.a.createElement("p",null,"Loading..."),c.a.createElement(m.a,{spinnerType:"spinner--lg"})))}},iBx0:function(e,t,n){"use strict";n("KKXr");t.a=function(e){if(e){var t=e.split("#");if(2===t.length){var n=t[1];if(n)return n}}return null}}}]);